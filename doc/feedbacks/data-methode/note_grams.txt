210130: what Grams et al 2017 do, in my understanding
--------------------------------------------------------------------

A) Citations from Grams et al. (2017) and references therein:
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

"EOF and k-means clustering"

"ËOF analysis on 10-day low-pass filtered geopotential height anomaly
(using a 90-day running mean at the respective calndar time as
reference climatology) at 500 hPa (Z500) in the domain 80W / 40E / 30N
/ 90N."

"The seasonal cycle in the amplitude of the anomaly is removed prior
to the EOF clustering by computing at each grid point the temporal
standard deviation in a running 30-day window for each calendar time,
and normalising Z500 by the spatial mean of this running standard
deviation in the EOF domain."

"The leading seven EOFs (76.7% of explained variance) are used for the
k-means clustering, which is repeated 10 times to test convergence to
a stable solution."

Citation from their reference #4:
"A cosine weight as a function of latitude is applied to the data"
---> also done in Grams et al? By us?

For basics on 'weather regime', may check out Vautard et al. 1990:
https://scholar.google.com/scholar_lookup?hl=en&volume=118&publication_year=1990&pages=2056-2080&journal=Mon.+Weather+Rev.&author=R.+Vautard&title=Multiple+weather+regimes+over+the+North+Atlantic%3A+Analysis+of+precursors+and+successors




B) Some basic thoughts on EOFs & k-clustering:
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

EOF: set up a 2D matrix, dimensions time (series) and space (2D map
becomes 1D vector); determine largest eigenvalues plus their
eigenvectos (e.g. via SVD)

k-means clustering: distribute all individual days (or 6-h data etc)
to one of k prototypes (EOF; Z500 fields; WeatherRegimes);

k-means clustering minimizes within-cluster variances (squared
Euclidean distances), but not regular Euclidean distances.

Seasonally different amplitudes of the Z500 anomalies do not matter
for the EOF analysis, I'd say. In essence, determining EOFs amounts to
finding eigenvectors and eigenvalues or, if you will, 'diagonalizing a
matrix'. For this problem, it does not matter if one row of a matrix
is a constant multiple of another row (i.e. if anomalies in summer are
systematically larger or smaller than in winter). Only the 'direction'
of the row (or column) vector of the matrix matters, not its 'length'.

For the clustering, where the goal is to minimize the intra-cluster
variance, the EOF amplitude (or 'length' of the vector) does matter instead.
A 'longer' vector results in a larger 'variabiliity'. So if I want
to cluster by 'feature' I must make sure that all vectors (EOFs) have the
same length before starting to cluster.




C) So, what does this all mean in practical terms, in my understanding?
   What, in my understanding (maybe I'm wrong!!!), did Grams et al. (2017) really do?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

The Z500 field from Era-Interim is analysed as follows:
a) for each time, at each point of the 2D field, compute Z500 minus 90-day mean field (90-day centered at t0)
   [one is interested in deviations / anomalies from the climatological mean]
b) for each time, at each point of the 2D anomaly field (see step a), apply 10-day low pass filtering
   [one is interested in 'weather regimes', not 'short term weather noise'; see Vautard et al. 1990]
c) to the time series of 2D, 10-day low-pass filtered Z500 anomaly fields, apply EOF analysis
   [retain the seven leading EOFs, explaining xx % of the variance of the 10-day low-pass filtered anomaly data]
   [these EOFs are our Weather Regimes, WR, subsequently used for the clustering]
   ---> THESE ARE OUR 7 WEATHER REGIMES
d) for each time, at each point of the 2D Z500 anomaly field, compute the 30-day standard deviation (in time)
   and take the spatial average of this standard deviation over the domain
   [this gives you one number for each time, the 2D spatial dimension has vanished via spatial averaging]
e) for each time, at each spatial point of the 10-day low-pass filtered Z500 anomaly field, divide
   by the value from point d) [the spatial domain average of all 30-days temporal standard deviations]
f) apply clustering to the data from e), i.e. to the time series of 2D fields of Z500 anomalies (90-day mean)
   that are low-pass filtered (10-days) and normalized in amplitude (30-day standard deviation, spatial mean)

Questions:
1) do we perform any weighting with cos(lat) or cos(lat)² before the EOF analysis?
   [instead of equal weight for each grid point, give less weight to grid points further north]
2) what low-pass filter did Grams et al use? did we use? Lanzos 15-point as Vautard???
3) do Grams et al. perform all their analysis on 6h data or do they first go to daily means?
4) are we doing the same? I would say, in parts. To me, it seems that (potentially relevant) differences
   are the time window of 90 days (30 days in our case) and the normalization by the spatially
   averaged (2D grid point specific in our case???) 30-day standard deviation. Another (potentially irrelevant)
   difference seems to be that we normalize Z500 by the 30-day standard deviation before computing EOFs.
   (Relevant here may be that we do not take (???) the spatial mean but use the point specific 30-day
   standard deviation)
   



